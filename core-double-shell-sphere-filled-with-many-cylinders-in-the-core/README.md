# Core double shell sphere filled with many cylinders in the core

Orientationally averaged form factor for a monodisperse spherical particle with a core-double-shell sphere structure, filled with circular cylinders in its core. Note that the platelets inside are monodisperse with a given radius_cylinder and length_cylinder. Their amount is controlled via the fit parameter volume fraction = N * V_cylinder/ V_shpere_core. The randomly distributed positions of the cylinders inside a sphere with radius radius_cylinder_avgsph within the core translates into a form amplitude for a sphere with radius 0 < radius_cylinder_avgsph < radius_sphere_core. Applying polydispersity to the cylinders means to have core-double-shell spheres with cylinders inside, which differ between spheres, but not within one sphere. Note that the platelets inside are monodisperse with a given radius_cylinder and length_cylinder. Their amount is controlled via the fit parameter volume fraction = N * V_cylinder/ V_shpere_core. The randomly distributed positions of the cylinders inside a sphere with radius radius_cylinder_avgsph within the core translates into a form amplitude for a sphere with radius 0 < radius_cylinder_avgsph < radius_sphere_core. Applying polydispersity to the cylinders means to have core-double-shell spheres with cylinders inside, which differ between spheres, but not within one sphere. Output: P(q) = \frac{\text{scale}}{V_{sph}} \int_0^{\pi/2} f^2(q,\alpha) \sin\alpha\ d\alpha + \text{background} where f(q,\alpha) = ( sld_{sph,sh2} - sld_{solv}    ) * V_{sph}   * f_sph( q*(R_{sph,c} + d_{sph,sh} + d_{sph,sh2}) ) + ( sld_{sph,sh}  - sld_{sph,sh2} ) * V_{sph,i} * f_sph( q*(R_{sph,c} + d_{sph,sh}) ) + ( sld_{sph,c}   - sld_{sph,sh}  ) * V_{sph,c} * f_sph( q*R_{sph,c} ) + ( sld_{cyl}     - sld_{sph,c}   ) * f_sph( q*R_{avgsph,cyl} ) * phi_{cyl} * V_{sph,c} * f_cyl(q,\alpha) Note: in case of one shell and sld_{cyl} == sld_{sph,sh} and R_{avgsph,cyl} = R_{sph,c} it simplifies to: f(q,\alpha) = ( sld_{sph,sh} - sld_{solv}   ) * V_{sph} * f_sph( q*(R_{sph,c}+d_{sph,sh}) ) + ( sld_{sph,c}  - sld_{sph,sh} ) * f_sph( q*R_{sph,c} ) * V_{sph,c} * ( 1.0 - phi_{cyl} f_cyl(q,\alpha) ) where f_cyl(q,alpha) = j_0( q*L_{cyl}*\cos(\alpha)/2 ) * 2J1x( q*R_{cyl}\sin(\alpha) ) f_sph(x) = 3 * \frac{ \sin(x)-x\cos(x) }{ x^3 } where j_0(x) = \sin(x) / x 2J1x(x) = 2 * J_1(x) / x , where $J_1$ is the first order Bessel function V_{cyl} = \pi R_{cyl}^2 L_{cyl} V_{avgsph,cyl} = 4\pi/3 R_{avgsph,cyl}^3 V_{sph,c} = 4\pi/3 R_{sph,c}^3 V_{sph} = 4\pi/3 (R_{sph,c}+d_{sph,sh})^3 Parameters: scale = scaling factor, volume fraction of particles scale phi ~ N V_{sph} / V_{irr}, with N / V_{irr} being the number density of particles in the irradiated volume phi_{cyl} = relative volume fraction of cylinders inside the core sphere phi_{cyl} ~ N V_{cyl} / V_{sph,c}, with N / V_{sph,c} being the number density of cylinders in the core sphere background = const. background R_{sph,c} = core radius of sphere d_{sph,sh} = inner shell thickness of sphere d_{sph,sh2} = outer shell thickness of sphere NB: R_{sph,c} + d_{sph,sh} = radius of whole sphere R_{cyl} = radius of one cylinder L_{cyl} = length of one cylinder R_{avgsph,cyl} = radius of the averaging sphere for the cylinders V_{sph} = volume of whole sphere including core and both shells V_{sph,i} = volume of sphere including core and inner shell V_{sph,c} = volume of sphere core V_{cyl} = volume of cylinder V_{avgsph,cyl} = volume of the averaging sphere for the cylinders sld_{sph,c} = scattering length density of core of sphere sld_{sph,sh} = scattering length density of inner shell of sphere sld_{sph,sh2} = scattering length density of outer shell of sphere sld_{cyl} = scattering length density of cylinders inside the core sld_{solv} = scattering length density of solvent

Orientationally averaged form factor for a monodisperse spherical particle with a core-double-shell sphere structure, filled with circular cylinders in its core.

Note that the platelets inside are monodisperse with a given radius_cylinder and length_cylinder. Their amount is controlled via the fit parameter volume fraction = N * V_cylinder/ V_shpere_core. The randomly distributed positions of the cylinders inside a sphere with radius radius_cylinder_avgsph within the core translates into a form amplitude for a sphere with radius 0 < radius_cylinder_avgsph < radius_sphere_core. Applying polydispersity to the cylinders means to have core-double-shell spheres with cylinders inside, which differ between spheres, but not within one sphere.

Note that the platelets inside are monodisperse with a given radius_cylinder and length_cylinder. Their amount is controlled via the fit parameter volume fraction = N * V_cylinder/ V_shpere_core. The randomly distributed positions of the cylinders inside a sphere with radius radius_cylinder_avgsph within the core translates into a form amplitude for a sphere with radius 0 < radius_cylinder_avgsph < radius_sphere_core. Applying polydispersity to the cylinders means to have core-double-shell spheres with cylinders inside, which differ between spheres, but not within one sphere.

Output: P(q) = \frac{\text{scale}}{V_{sph}} \int_0^{\pi/2} f^2(q,\alpha) \sin\alpha\ d\alpha + \text{background}

where f(q,\alpha) = ( sld_{sph,sh2} - sld_{solv}    ) * V_{sph}   * f_sph( q*(R_{sph,c} + d_{sph,sh} + d_{sph,sh2}) ) + ( sld_{sph,sh}  - sld_{sph,sh2} ) * V_{sph,i} * f_sph( q*(R_{sph,c} + d_{sph,sh}) ) + ( sld_{sph,c}   - sld_{sph,sh}  ) * V_{sph,c} * f_sph( q*R_{sph,c} ) + ( sld_{cyl}     - sld_{sph,c}   ) * f_sph( q*R_{avgsph,cyl} ) * phi_{cyl} * V_{sph,c} * f_cyl(q,\alpha)

Note: in case of one shell and sld_{cyl} == sld_{sph,sh} and R_{avgsph,cyl} = R_{sph,c} it simplifies to: f(q,\alpha) = ( sld_{sph,sh} - sld_{solv}   ) * V_{sph} * f_sph( q*(R_{sph,c}+d_{sph,sh}) ) + ( sld_{sph,c}  - sld_{sph,sh} ) * f_sph( q*R_{sph,c} ) * V_{sph,c} * ( 1.0 - phi_{cyl} f_cyl(q,\alpha) )

where f_cyl(q,alpha) = j_0( q*L_{cyl}*\cos(\alpha)/2 ) * 2J1x( q*R_{cyl}\sin(\alpha) ) f_sph(x) = 3 * \frac{ \sin(x)-x\cos(x) }{ x^3 }

where j_0(x) = \sin(x) / x 2J1x(x) = 2 * J_1(x) / x , where $J_1$ is the first order Bessel function V_{cyl} = \pi R_{cyl}^2 L_{cyl} V_{avgsph,cyl} = 4\pi/3 R_{avgsph,cyl}^3 V_{sph,c} = 4\pi/3 R_{sph,c}^3 V_{sph} = 4\pi/3 (R_{sph,c}+d_{sph,sh})^3

Parameters: scale = scaling factor, volume fraction of particles scale phi ~ N V_{sph} / V_{irr}, with N / V_{irr} being the number density of particles in the irradiated volume phi_{cyl} = relative volume fraction of cylinders inside the core sphere phi_{cyl} ~ N V_{cyl} / V_{sph,c}, with N / V_{sph,c} being the number density of cylinders in the core sphere background = const. background R_{sph,c} = core radius of sphere d_{sph,sh} = inner shell thickness of sphere d_{sph,sh2} = outer shell thickness of sphere NB: R_{sph,c} + d_{sph,sh} = radius of whole sphere R_{cyl} = radius of one cylinder L_{cyl} = length of one cylinder R_{avgsph,cyl} = radius of the averaging sphere for the cylinders V_{sph} = volume of whole sphere including core and both shells V_{sph,i} = volume of sphere including core and inner shell V_{sph,c} = volume of sphere core V_{cyl} = volume of cylinder V_{avgsph,cyl} = volume of the averaging sphere for the cylinders sld_{sph,c} = scattering length density of core of sphere sld_{sph,sh} = scattering length density of inner shell of sphere sld_{sph,sh2} = scattering length density of outer shell of sphere sld_{cyl} = scattering length density of cylinders inside the core sld_{solv} = scattering length density of solvent

Source: https://marketplace.sasview.org/models/121/
