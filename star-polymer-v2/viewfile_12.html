
<!DOCTYPE html>

<html>
<head>
<meta charset="utf-8"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<title>View File | SasView Model Marketplace</title>
<link crossorigin="anonymous" href="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha384-HSMxcRTRxnN+Bdg0JdbxYKrThecOKuH5zCYotlSAcp1+c8xmyTe9GYg1l9a69psu" rel="stylesheet"/>
<link charset="utf-8" href="/static/marketplace/style.css" rel="stylesheet">
<link href="/static/marketplace/ball.ico" rel="shortcut icon" type="image/x-icon"/>
<script charset="utf-8" src="/static/marketplace/jquery-2.2.4.min.js"></script>
<script crossorigin="anonymous" integrity="sha384-aJ21OjlMXNL5UyIl/XNwTMqvzeRMZH2w8c5cRVpzpU8Y5bApTppSuUkhZXN0VxHd" src="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
<link href="/static/marketplace/tomorrow-night.css" rel="stylesheet"/>
<script src="/static/marketplace/highlight.pack.js"></script>
<script type="text/javascript">
    hljs.initHighlightingOnLoad();
</script>
</link></head>
<body>
<nav class="navbar navbar-inverse navbar-fixed-top">
<div class="container container-fluid">
<div class="navbar-header">
<button aria-expanded="false" class="navbar-toggle collapsed" data-target="#navbar-collapse-1" data-toggle="collapse" type="button">
<span class="sr-only">Toggle navigation</span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</button>
<img src="/static/marketplace/logo.png"/><a class="navbar-brand" href="/">SasView Marketplace</a>
</div>
<div class="collapse navbar-collapse" id="navbar-collapse-1">
<ul class="nav navbar-nav navbar-right">
<li><a href="/accounts/login/"><span class="glyphicon glyphicon-log-in"></span> Log In </a></li>
</ul>
<form action="/search/" class="navbar-form navbar-left" method="get">
<div class="form-group">
<input class="form-control" name="query" placeholder="Search" type="text"/>
</div>
<button class="btn btn-default" type="submit"><span class="glyphicon glyphicon-search"></span></button>
</form>
</div><!-- /.navbar-collapse -->
</div>
</nav>
<div class="container">
<ol class="breadcrumb">
<li><a href="/">Categories</a></li>
<li><a href="/models/shape-independent/">Shape-Independent</a></li>
<li><a href="/models/12/">star_polymer_v2</a></li>
<li><a href="/uploads/12">star_polymer_v2.py</a></li>
</ol>
<h1>star_polymer_v2 - star_polymer_v2.py</h1>
<pre>
    <code>r"""
The Benoit model for a simple star polymer, with Gaussian coils arms from
a common point.
[TEST new version May 2017, fit Rg not (Rg)^2, start to check results at very small Q,
see tickets #552 &amp; #962 ]

Definition
----------

For a star with $f$ arms the scattering intensity $I(q)$ is calculated as

.. math::

    I(q) = frac{2}{fv^2}left[ v-1+exp(-v)+frac{f-1}{2}
           left[ 1-exp(-v)ight]^2ight]

where

.. math:: v=frac{u^2f}{(3f-2)}

and

.. math:: u = leftlangle R_{g}ightangle q^2

Rg is the radius-of-gyration of the whole star.
Note that when there is only one arm, $f = 1$, the Debye Gaussian coil
equation is recovered. Star polymers in solutions tend to have strong
interparticle and osmotic effects, so the Benoit equation may not work well.
See discussions in literature, such as Willner et.al.

At small $q$ the Guinier term and hence $I(q=0)$ is the same as for $f$ arms
of radius of gyration $R_g$, as described for the :ref:`mono-gauss-coil` model.

References
----------

H Benoit *J. Polymer Science*, 11, 596-599 (1953)

L.Willner, O.Jucknischke, D.Richter, J.Roovers, L.-L. Zhou, P.M.Toporowski,
L.J.Fetters, J.S.Huang, M.Y.Lin &amp; N.Hadjichristidis, Macromolecules 27, 3821-3829 (1994)
"""

from numpy import inf

name = "star_polymer_v2"
title = "Star polymer model with Gaussian statistics"
description = """
        Benoit 'Star polymer with Gaussian statistics'
        with
        P(q) = 2/{fv^2} * (v - (1-exp(-v)) + {f-1}/2 * (1-exp(-v))^2)
        where
        - v = u.f/(3f-2)
        - u = &lt;R_g^2&gt;q^2, where &lt;R_g^2&gt; is the ensemble average radius of
        gyration of the whole star
        - f is the number of arms in the star
        """
category = "shape-independent"
single = False
# pylint: disable=bad-whitespace, line-too-long
#             ["name", "units", default, [lower, upper], "type","description"],
parameters = [["rg", "Ang^2", 10.0, [0.0, inf], "", "radius of gyration of star"],
              ["arms",    "",      3,   [1.0, 6.0], "", "Number of arms in the star"],
             ]
# pylint: enable=bad-whitespace, line-too-long

source = ["star_polymer_v2.c"]

demo = dict(scale=1, background=0,
            rg= 10.0,
            arms=3.0)

tests = [[{'rg': 1.414213562,
           'arms':    3.3,
          }, 0.5, 0.851646091108],

         [{'rg':    1.0,
           'arms':       2.0,
           'background': 1.8,
          }, 1.0, 2.53575888234],
        ]
# 23Mar2016  RKH edited docs, would this better use rg not rg^2 ? Numerical noise at extremely small q.rg
# 22May2017 RKH starts version2
</code>
</pre>
<a class="btn btn-default" href="/models/12/">Back to Model</a>
<a class="btn btn-primary" href="/uploads/uploaded_models/star_polymer_v2.py"><span class="glyphicon glyphicon-download"></span> Download</a>
</div>
</body>
</html>
