
<!DOCTYPE html>

<html>
<head>
<meta charset="utf-8"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<title>Cumulants | SasView Model Marketplace</title>
<link crossorigin="anonymous" href="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha384-HSMxcRTRxnN+Bdg0JdbxYKrThecOKuH5zCYotlSAcp1+c8xmyTe9GYg1l9a69psu" rel="stylesheet"/>
<link charset="utf-8" href="/static/marketplace/style.css" rel="stylesheet">
<link href="/static/marketplace/ball.ico" rel="shortcut icon" type="image/x-icon"/>
<script charset="utf-8" src="/static/marketplace/jquery-2.2.4.min.js"></script>
<script crossorigin="anonymous" integrity="sha384-aJ21OjlMXNL5UyIl/XNwTMqvzeRMZH2w8c5cRVpzpU8Y5bApTppSuUkhZXN0VxHd" src="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
<script async="" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML" type="text/javascript">
</script>
<script type="text/javascript">
    $(function() {
        $('[data-toggle="tooltip"]').tooltip()
    })
    window.MathJax = ({
        elements: ["model-desc"],
        tex2jax: {
            inlineMath: [ ['$', '$'], [ "\\(", "\\)" ] ],
            processEscapes: true
        },
        asciimath2jax: {
            delimiters: [],
        },
        CommonHTML: { linebreaks: { automatic: true } },
        "HTML-CSS": { linebreaks: { automatic: true } },
        SVG: { linebreaks: { automatic: true } }
    });
</script>
</link></head>
<body>
<nav class="navbar navbar-inverse navbar-fixed-top">
<div class="container container-fluid">
<div class="navbar-header">
<button aria-expanded="false" class="navbar-toggle collapsed" data-target="#navbar-collapse-1" data-toggle="collapse" type="button">
<span class="sr-only">Toggle navigation</span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</button>
<img src="/static/marketplace/logo.png"/><a class="navbar-brand" href="/">SasView Marketplace</a>
</div>
<div class="collapse navbar-collapse" id="navbar-collapse-1">
<ul class="nav navbar-nav navbar-right">
<li><a href="/accounts/login/"><span class="glyphicon glyphicon-log-in"></span> Log In </a></li>
</ul>
<form action="/search/" class="navbar-form navbar-left" method="get">
<div class="form-group">
<input class="form-control" name="query" placeholder="Search" type="text"/>
</div>
<button class="btn btn-default" type="submit"><span class="glyphicon glyphicon-search"></span></button>
</form>
</div><!-- /.navbar-collapse -->
</div>
</nav>
<div class="container">
<ol class="breadcrumb">
<li><a href="/">Categories</a></li>
<li><a href="/models/dls/">DLS</a></li>
<li><a href="/models/132/">Cumulants</a></li>
</ol>
<h1>Cumulants</h1>
<h2>Description:</h2>
<div class="container" id="model-desc">
<p>
<p>The Method of Cumulants.</p>
<p>Definition</p>
<p>THIS MODEL IS NOT INTENDED FOR THE ANALYSIS OF SAXS/SANS DATA!</p>
<p>This model is in part provided to illustrate the utility of SasView as a fitting program for the analysis of input data that is not $I(q)$ vs $q$. But at the same time it usefully provides a basic means of analysing Dynamic Light Scattering (DLS) data using the Method of Cumulants (Koppel, 1972).</p>
<p>Note: The Method of Cumulants is only valid if the particle size distribution is monomodal. However, the size distribution can be polydisperse.</p>
<p>Input Data</p>
<p>The input data can be in any data format recognised by the SasView data loader, though a format containing delimited two-column ASCII text will probably be the most convenient.</p>
<p>SasView will look for the first pair of numerical values in the file, so it is permissible to prefix the data with some lines of metadata and/or column headers, but none of these will be imported. If the file contains multiple data blocks it is likely that only the first one will be imported, so it is important that the data you want to fit is the first data block in the file. This reasonable degree of flexibility means that in some instances data files output by commercial correlators can be read by SasView 'as is', without any need for reformatting.</p>
<p>For example, this is a text format output by an LSi Correlator (see https://lsinstruments.ch/en/) :<br/> <br/>    03/08/2020	17:30 PM<br/>    Pseudo Cross Correlation<br/>    Scattering angle:	110.0<br/>    Duration (s):	60<br/>    Wavelength (nm):	642.0<br/>    Refractive index:	1.330<br/>    Viscosity (mPas):	0.854<br/>    Temperature (K):	309.0<br/>    Laser intensity (mW):	0.0<br/>    Average Count rate  A (kHz):	19388.1<br/>    Average Count rate  B (kHz):	19388.1<br/>    Intercept:	1.0000<br/>    Cumulant 1st	-Inf<br/>    Cumulant 2nd	-Inf	NaN<br/>    Cumulant 3rd	-Inf	NaN</p>
<p>    Lag time (s)         g2-1<br/>    0.000000e+00	2.153341e+02<br/>    1.250000e-08	-1.000000e+00<br/>    2.500000e-08	1.897621e-02<br/>    3.750000e-08	1.454616e+00<br/>    5.000000e-08	1.040391e+00<br/>    6.250000e-08	9.113997e-01<br/>    7.500000e-08	8.547216e-01<br/>    8.750000e-08	8.269044e-01<br/>    1.000000e-07	7.905431e-01<br/>    1.125000e-07	7.863978e-01<br/>    1.250000e-07	7.645010e-01<br/>    1.375000e-07	7.728501e-01<br/>    1.500000e-07	7.646473e-01<br/>    1.625000e-07	7.516946e-01<br/>    1.750000e-07	7.575662e-01<br/>    1.875000e-07	7.556643e-01<br/>    2.000000e-07	7.547962e-01<br/>    ...<br/>    5.033165e+01	-5.472073e-03</p>
<p>    Count Rate History (KHz)  CR CHA / CR CHB<br/>    0.000000	18560.000000	18560.000000<br/>    ...<br/>    59.926118	16078.000000	16078.000000</p>
<p>In this example, SasView ignores all the metadata preceding the first (two-column) data block, the correlation function, and ignores everything after the two-column data block.</p>
<p>Whatever the file format it is imperative that the correct data is placed in these the two columns:</p>
<p>    Column 1: what would normally be $q$:    Correlator time or $\tau$ (in seconds)<br/> <br/>    Column 2: what would normally be $I(q)$: Normalised Intensity Autocorrelation Function, $G2(\tau)$</p>
<p>Method of Analysis</p>
<p>For a monomodal dispersion of MONODISPERSE scatterers</p>
<p>    $$G2(\tau) = \text{A} \cdot exp(-2 \Gamma \tau) + \text{background}$$</p>
<p>where $\Gamma = D \cdot q^2$ is the decay rate, $D$ is the mutual diffusion coefficient and $q$ is the scattering vector.</p>
<p>For a monomodal dispersion of POLYDISPERSE scatterers Koppel showed</p>
<p>(FORMULA 1)<br/>    $$G2(\tau) = \text{A} \cdot exp(-2 \Gamma_1 \tau + \Gamma_2 \tau^2 - (1/3) \Gamma_3 \tau^3 + ...) + \text{background}$$</p>
<p>where each $\Gamma$ is a cumulant of the distribution of decay rates arising from the different sized scatterers. However, this function is unstable. A more stable function is (Pusey et al, 1974; Frisken, 2001; Mailer et al, 2015)</p>
<p>(FORMULA 2)<br/>    $$G2(\tau) = \text{A} \cdot exp(-2 \Gamma_1 \tau) \cdot (1 + (1/2) \Gamma_2 \tau^2 - (1/6) \Gamma_3 \tau^3 + ...)^2 + \text{background}$$</p>
<p>Here $\Gamma_1$ is now the AVERAGE decay rate (representing a weighted average of the different diffusion coefficients) and $\Gamma_2$ is related to the relative polydispersity index, $PDI = \Gamma_2 / \Gamma_1^2$.</p>
<p>The third cumulant is related to the SKEWNESS of the decay rate distribution ($\Gamma_3 / \Gamma_2^{3/2}$) and the fourth cumulant (not implemented in this model) gives the KURTOSIS ($\Gamma_4 / \Gamma_2^2$). Further cumulants are rarely, if ever, used.</p>
<p>FORMULA 2 is used by default in this model, but both formulae are provided below. Simply comment/uncomment whichever is required.</p>
<p>Using this Model</p>
<p>The $scale$ parameter will be what many commercial DLS software packages refer to as the $Intercept$ of the correlation function. This must be between 0 and 1, but for the data to have any real meaning it should be between 0.6 and 1.</p>
<p>If the correlator has supplied its output as $G2(\tau)-1$ (as in the data file example above) then $background$ should be essentially zero.</p>
<p>Do not attempt to fit all of the tail of the correlation function. Use the min and max $q$-range for fitting boxes to limit the fit range to a sensible region of the correlation function. You only need to fit the decay and the start of the tail.</p>
<p>The best way to approach fitting the data is to gradually increase the number of cumulants being fitted. So, initially, set $cumulant2$ and $cumulant3$ to zero, and fit (check the boxes) the parameters $scale$, $background$ and $cumulant1$. Then fit $cumulant2$. Then (if required) fit $cumulant3$.</p>
<p>To view the fit it will probably be helpful to change the y-axis scale from the SasView default of log(y) to y. To do this, right-click on the graph. It is also possible to change the x and y axis labels from their SasView defaults of $q$ and $intensity$.</p>
<p>Notes</p>
<p>This model is inspired by a similar model in the SASfit model-fitting package (Kohlbrecher, 2020).</p>
<p>Also see the model cumulants_dls in the SasView Marketplace.</p>
<p>References</p>
<p>1.  D. E. Koppel. Analysis of macromolecular polydispersity in intensity correlation spectroscopy: The method of cumulants. The Journal of Chemical Physics, (1972), 57(11), <br/>    4814-4820. <br/>2.  P. N. Pusey, D. E. Koppel, D. E. Schaefer, R. D. Camerini-Otero, and S. H. Koenig. Intensity fluctuation spectroscopy of laser light scattered by solutions of spherical viruses. <br/>     r17, q.beta., BSV, PM2, and t7. i. light-scattering technique. Biochemistry, (1974), 13(5), 952-960.<br/>3.  B. J. Frisken. Revisiting the method of cumulants for the analysis of dynamic light-scattering data. Applied Optics, (2001), 40(24), 4087.<br/>4.  A. G. Mailer, P. S. Clegg, and P. N. Pusey. Particle sizing by dynamic light scattering: nonlinear cumulant analysis. Journal of Physics: Condensed Matter, (2015), 27(14), <br/>    145102.<br/>5.  J. Stetefeld, S. A. McKenna1 &amp; T. R. Patel. Dynamic light scattering: a practical guide and applications in biomedical sciences. Biophys Rev (2016), 8, 409-427.<br/>6.  J. Kohlbrecher. User guide for the SASfit software package. Chapter 13. June 2020.</p>
<p>Verification</p>
<p>The model has been tested by comparing its output to that from the commercial LSi correlator software using the same input data and range of $\tau$.</p>
<p>For a nominal 30 nm diameter PS latex standard:</p>
<p>    LSi         : intercept = 0.771, cumulant1 = 6700.0 /s, cumulant2 = 5.61E+06 /s^2, cumulant3 = -9.99E+08 /s^3<br/>    SasView: intercept = 0.744, cumulant1 = 6031.1 /s, cumulant2 = 1.39E+05 /s^2, cumulant3 = -2.53E+10 /s^3<br/> <br/>For a PNIPAM microgel:</p>
<p>    LSi         : intercept = 0.69, cumulant1 = 517.0 /s, cumulant2 = 6.45E+04 /s^2, cumulant3 = -5.0E+06 /s^3<br/>    SasView: intercept = 0.73, cumulant1 = 511.4 /s, cumulant2 = 1.36E+05 /s^2, cumulant3 = -4.7E+07 /s^3<br/> <br/>Visually, SasView appears to do a much better job of fitting the data than the commercial software. This may reflect the fact that SasView has much better optimisers. But which formula the commercial software is using is also unknown.</p>
<p>Authorship History</p>
<p>Author: Steve King Date: 26/08/2020<br/>Last Modified by: Date:<br/>Last Reviewed by: Date:</p>
</p>
</div>
<h2>Details:</h2>
<table class="table">
<tr>
<td><strong>Created By</strong></td>
<td><a href="/accounts/user/3/">smk78</a></td>
</tr>
<tr>
<td><strong>Uploaded</strong></td>
<td>Aug. 26, 2020, 8:12 a.m.</td>
</tr>
<tr>
<td><strong>Category</strong></td>
<td>DLS</td>
</tr>
<tr>
<td><strong>Score</strong></td>
<td>0
        
        </td>
</tr>
<tr>
<td><strong>Verified</strong></td>
<td>
<span class="text-danger"><span class="glyphicon glyphicon-remove"></span> This model has not been verified by a member of the SasView team</span>
</td>
</tr>
<tr>
<td><strong>In Library</strong></td>
<td>
            
                This model is not currently included in the SasView library. You must download the files and install it yourself.
            
        </td>
</tr>
<tr>
<td><strong>Files</strong></td>
<td>
<a href="/uploads/625">cumulants.py</a><br>
</br></td>
</tr>
</table>
<h3>Comments:</h3>
<p>
        No comments yet.
    </p>
<p>
        Please log in to add a comment.
    </p>
</div>
</body>
</html>
