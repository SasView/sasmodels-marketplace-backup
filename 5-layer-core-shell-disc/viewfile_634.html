
<!DOCTYPE html>

<html>
<head>
<meta charset="utf-8"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<title>View File | SasView Model Marketplace</title>
<link crossorigin="anonymous" href="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha384-HSMxcRTRxnN+Bdg0JdbxYKrThecOKuH5zCYotlSAcp1+c8xmyTe9GYg1l9a69psu" rel="stylesheet"/>
<link charset="utf-8" href="/static/marketplace/style.css" rel="stylesheet">
<link href="/static/marketplace/ball.ico" rel="shortcut icon" type="image/x-icon"/>
<script charset="utf-8" src="/static/marketplace/jquery-2.2.4.min.js"></script>
<script crossorigin="anonymous" integrity="sha384-aJ21OjlMXNL5UyIl/XNwTMqvzeRMZH2w8c5cRVpzpU8Y5bApTppSuUkhZXN0VxHd" src="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
<link href="/static/marketplace/tomorrow-night.css" rel="stylesheet"/>
<script src="/static/marketplace/highlight.pack.js"></script>
<script type="text/javascript">
    hljs.initHighlightingOnLoad();
</script>
</link></head>
<body>
<nav class="navbar navbar-inverse navbar-fixed-top">
<div class="container container-fluid">
<div class="navbar-header">
<button aria-expanded="false" class="navbar-toggle collapsed" data-target="#navbar-collapse-1" data-toggle="collapse" type="button">
<span class="sr-only">Toggle navigation</span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</button>
<img src="/static/marketplace/logo.png"/><a class="navbar-brand" href="/">SasView Marketplace</a>
</div>
<div class="collapse navbar-collapse" id="navbar-collapse-1">
<ul class="nav navbar-nav navbar-right">
<li><a href="/accounts/login/"><span class="glyphicon glyphicon-log-in"></span> Log In </a></li>
</ul>
<form action="/search/" class="navbar-form navbar-left" method="get">
<div class="form-group">
<input class="form-control" name="query" placeholder="Search" type="text"/>
</div>
<button class="btn btn-default" type="submit"><span class="glyphicon glyphicon-search"></span></button>
</form>
</div><!-- /.navbar-collapse -->
</div>
</nav>
<div class="container">
<ol class="breadcrumb">
<li><a href="/">Categories</a></li>
<li><a href="/models/cylinder/">Cylinder</a></li>
<li><a href="/models/137/">5 Layer Core Shell Disc</a></li>
<li><a href="/uploads/634">five_layer_core_shell_bicelle.c</a></li>
</ol>
<h1>5 Layer Core Shell Disc - five_layer_core_shell_bicelle.c</h1>
<pre>
    <code>//Updated: October 3, 2020 - Cleaning comments
//Updated: December 7, 2020 - Cleaning comments
//Updated: December 8, 2020 - Cleaning comments

double form_volume(double radius, double thick_rim, double thick_face, double length1, double length2);
double Iq(double q,
		  double radius,
		  double thick_rim,
		  double thick_face,
		  double methylene_length,
		  double methyl_length,
		  double methylene_sld,
		  double methyl_sld,
		  double face_sld,
		  double rim_sld,
		  double solvent_sld);


double Iqxy(double qx, double qy,
		    double radius,
		    double thick_rim,
		    double thick_face,
		    double methylene_length,
		    double methyl_length,
			double methylene_sld,
			double methyl_sld,
			double face_sld,
			double rim_sld,
			double solvent_sld,
			double theta,
			double phi);

double add(double a, double b)
{
	double sum;
	sum = 2.0*a + b;
	return sum;
}

double form_volume(double radius, double thick_rim, double thick_face, double length1, double length2)
{
	return M_PI*(radius+thick_rim)*(radius+thick_rim)*(2.0*length1+length2+2.0*thick_face);
}

static double
bicellemod_kernel(double qq,
              double rad,
              double radthick,
              double facthick,
			  double length1,
			  double halflength2,
              double rhol1,
			  double rhol2,
              double rhoh,
              double rhor,
              double rhosolv,
              double sin_alpha,
              double cos_alpha)

{
    double si1,si2,si3,be1,be2;
	const double dr1 = rhol1 - rhoh;
	const double dr2 = rhor - rhosolv;
	const double dr3 = rhoh - rhor;
	const double dr4 = rhol2 - rhol1;
// Core length is a generic variable for halfway from center to face, not the length of the core.
// Core radius does not include phospholipid heads.
	const double vol1 = M_PI*rad*rad*2.0*(length1+halflength2);
    const double vol2 = M_PI*(rad+radthick)*(rad+radthick)*2.0*(length1+halflength2+facthick);
    const double vol3 = M_PI*rad*rad*2.0*(length1+halflength2+facthick);
	const double vol4 = M_PI*rad*rad*(2.0*halflength2);
    double besarg1 = qq*rad*sin_alpha;
    double besarg2 = qq*(rad+radthick)*sin_alpha;
// Should take the difference between each core section and rim.
    double sinarg1 = qq*(length1+halflength2)*cos_alpha;
    double sinarg2 = qq*(length1+halflength2+facthick)*cos_alpha;
	double sinarg3 = qq*(halflength2)*cos_alpha;
    be1 = sas_2J1x_x(besarg1);
    be2 = sas_2J1x_x(besarg2);
    si1 = sas_sinx_x(sinarg1);
    si2 = sas_sinx_x(sinarg2);
	si3 = sas_sinx_x(sinarg3);

    const double t = vol1*dr1*si1*be1 +
                     vol2*dr2*si2*be2 +
                     vol3*dr3*si2*be1 +
					 vol4*dr4*si3*be1;

    const double retval = t*t*sin_alpha;

    return retval;

}

static double
bicelle_integration(double qq,
		double rad,
		double radthick,
		double facthick,
	    double length1,
		double length2,
		double rhol1,
	    double rhol2,
		double rhoh,
		double rhor,
		double rhosolv)
{
    // set up the integration end points
    const double uplim = M_PI_4;
	const double halflength2 = 0.5*length2;
    double summ = 0.0;
    for(int i=0;i&lt;GAUSS_N;i++) {
        double alpha = (GAUSS_Z[i] + 1.0)*uplim;
        double sin_alpha, cos_alpha; // slots to hold sincos function output
        SINCOS(alpha, sin_alpha, cos_alpha);
        double yyy = GAUSS_W[i] * bicellemod_kernel(qq, rad, radthick, facthick,
												length1, halflength2, rhol1, rhol2,
												rhoh, rhor, rhosolv,
												sin_alpha, cos_alpha);
        summ += yyy;
    }

    // calculate value of integral to return
    double answer = uplim*summ;
    return answer;
}

static double
bicellemod_kernel_2d(double qx, double qy,
          double radius,
          double thick_rim,
          double thick_face,
          double methylene_length,
		  double methyl_length,
		  double methylene_sld,
		  double methyl_sld,
          double face_sld,
          double rim_sld,
          double solvent_sld,
          double theta,
          double phi)
{
    double q, sin_alpha, cos_alpha;
    ORIENT_SYMMETRIC(qx, qy, theta, phi, q, sin_alpha, cos_alpha);
	double answer = bicellemod_kernel(q, radius, thick_rim, thick_face,
		methylene_length, 0.5*methyl_length, methylene_sld, methyl_sld,
		face_sld, rim_sld, solvent_sld,
		sin_alpha, cos_alpha) / fabs(sin_alpha);

    answer *= 1.0e-4;

    return answer;
}

double Iq(double q,
		double radius,
		double thick_rim,
		double thick_face,
		double methylene_length,
	    double methyl_length,
		double methylene_sld,
		double methyl_sld,
		double face_sld,
		double rim_sld,
		double solvent_sld)
{
    double intensity = bicelle_integration(q, radius, thick_rim, thick_face,
                       methylene_length, methyl_length, methylene_sld, methyl_sld, face_sld, rim_sld, solvent_sld);
    return intensity*1.0e-4;
}


double Iqxy(double qx, double qy,
          double radius,
          double thick_rim,
          double thick_face,
          double methylene_length,
		  double methyl_length,
		  double methylene_sld,
		  double methyl_sld,
          double face_sld,
          double rim_sld,
          double solvent_sld,
          double theta,
          double phi)
{
    double intensity = bicellemod_kernel_2d(qx, qy,
                      radius,
                      thick_rim,
                      thick_face,
                      methylene_length,
					  methyl_length,
                      methylene_sld,
					  methyl_sld,
                      face_sld,
                      rim_sld,
                      solvent_sld,
                      theta,
                      phi);

    return intensity;
}</code>
</pre>
<a class="btn btn-default" href="/models/137/">Back to Model</a>
<a class="btn btn-primary" href="/uploads/uploaded_models/five_layer_core_shell_bicelle.c"><span class="glyphicon glyphicon-download"></span> Download</a>
</div>
</body>
</html>
